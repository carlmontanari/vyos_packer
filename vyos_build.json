{
    "builders": [
        {
            "name": "{{user `name`}}",
            "vm_name": "{{user `name`}}",
            "type": "vmware-iso",
            "guest_os_type": "other",
            "format": "vmx",
            "iso_url": "{{user `iso_path`}}",
            "iso_checksum_type": "md5",
            "iso_checksum": "{{user `iso_checksum`}}",
            "output_directory": "",
            "remote_host": "{{user `esxi_host`}}",
            "remote_datastore": "{{user `datastore`}}",
            "remote_username": "{{user `esxi_user`}}",
            "remote_password": "{{user `esxi_password`}}",
            "remote_type": "esx5",
            "communicator": "ssh",
            "ssh_username": "{{user `vyos_user`}}",
            "ssh_password": "{{user `vyos_password`}}",
            "ssh_wait_timeout": "1m",
            "vnc_disable_password": true,
            "disk_size": "10240",
            "disk_type_id": "zeroedthick",
            "disk_adapter_type": "scsi",
            "vmx_data": {
                "memsize": "{{user `vyos_memory`}}",
                "numvcpus": "{{user `vyos_cpu`}}",
                "ethernet0.virtualDev": "vmxnet3",
                "ethernet0.present": "true",
                "ethernet0.startConnected": "true",
                "ethernet0.dvs.switchId": "{{user `vsphere_dvs_uuid`}}",
                "ethernet0.dvs.portgroupId": "{{user `port_group_id`}}"
            },
            "boot_wait": "45s",
            "boot_command": [
                "vyos",
                "<enter>",
                "vyos",
                "<enter>",
                "install image",
                "<enter>",
                "<wait1>",
                "yes",
                "<enter>",
                "<wait1>",
                "<enter>",
                "<wait1>",
                "<enter>",
                "yes",
                "<enter>",
                "<enter>",
                "<wait15>",
                "<enter>",
                "<wait5>",
                "<enter>",
                "vyos",
                "<enter>",
                "vyos",
                "<enter>",
                "<enter>",
                "<wait5>",
                "configure",
                "<enter>",
                "set service ssh port '22'",
                "<enter>",
                "edit interfaces ethernet eth0",
                "<enter>",
                "set address dhcp ",
                "<enter>",
                "commit",
                "<enter>",
                "save",
                "<enter>"
            ],
            "keep_registered": "{{user `keep_registered`}}",
            "skip_export": "{{user `packer_skip_export`}}"
        }
    ]
}
